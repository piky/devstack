{
  "comments": [
    {
      "key": {
        "uuid": "3afb71cf_509848c0",
        "filename": "/COMMIT_MSG",
        "patchSetId": 1
      },
      "lineNbr": 11,
      "author": {
        "id": 7715
      },
      "writtenOn": "2015-06-08T15:11:30Z",
      "side": 1,
      "message": "Who needs the patch? If enabled q-l3 service, user should get metadata via router.",
      "revId": "29a733a307dd57e176799286e5e27c2194eb3d2b",
      "serverId": "4a232e18-c5a9-48ee-94c0-e04e7cca6543",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "3afb71cf_2a79d7f6",
        "filename": "/COMMIT_MSG",
        "patchSetId": 1
      },
      "lineNbr": 11,
      "author": {
        "id": 14232
      },
      "writtenOn": "2015-06-08T17:14:26Z",
      "side": 1,
      "message": "This patch is needed by functional tests in Manila project (https://review.openstack.org/#/c/187550/4/contrib/ci/pre_test_hook.sh).\n\nIn the case when we have isolated network (without gateway) it\u0027s impossible to get metadata without enabled options enable_isolated_metadata and/or enable_metadata_network.\n\nSo devstack should allow.",
      "parentUuid": "3afb71cf_509848c0",
      "revId": "29a733a307dd57e176799286e5e27c2194eb3d2b",
      "serverId": "4a232e18-c5a9-48ee-94c0-e04e7cca6543",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "3afb71cf_5a873ed7",
        "filename": "/COMMIT_MSG",
        "patchSetId": 1
      },
      "lineNbr": 11,
      "author": {
        "id": 7715
      },
      "writtenOn": "2015-06-08T18:09:37Z",
      "side": 1,
      "message": "\u003e In the case when we have isolated network (without gateway)\nI don\u0027t know manila. Why don\u0027t you set \"disable_service q-l3\" to local.conf in the test if without gateway?",
      "parentUuid": "3afb71cf_2a79d7f6",
      "revId": "29a733a307dd57e176799286e5e27c2194eb3d2b",
      "serverId": "4a232e18-c5a9-48ee-94c0-e04e7cca6543",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "3afb71cf_f3a4c1a6",
        "filename": "/COMMIT_MSG",
        "patchSetId": 1
      },
      "lineNbr": 11,
      "author": {
        "id": 14232
      },
      "writtenOn": "2015-06-09T06:14:06Z",
      "side": 1,
      "message": "Why I need to choose if I need both options (enabled q-l3 and isolated networks with metadata)? :)",
      "parentUuid": "3afb71cf_5a873ed7",
      "revId": "29a733a307dd57e176799286e5e27c2194eb3d2b",
      "serverId": "4a232e18-c5a9-48ee-94c0-e04e7cca6543",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "3afb71cf_a3425f66",
        "filename": "/COMMIT_MSG",
        "patchSetId": 1
      },
      "lineNbr": 11,
      "author": {
        "id": 7715
      },
      "writtenOn": "2015-06-09T15:53:56Z",
      "side": 1,
      "message": "I guess that neutron doesn\u0027t expect users to use both isolated metadata and l3agent at the same time, so current code prevents users from doing.",
      "parentUuid": "3afb71cf_f3a4c1a6",
      "revId": "29a733a307dd57e176799286e5e27c2194eb3d2b",
      "serverId": "4a232e18-c5a9-48ee-94c0-e04e7cca6543",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "3afb71cf_117a7d77",
        "filename": "/COMMIT_MSG",
        "patchSetId": 1
      },
      "lineNbr": 11,
      "author": {
        "id": 14232
      },
      "writtenOn": "2015-06-10T05:45:51Z",
      "side": 1,
      "message": "Why do you think so? l3-agent (q-l3) and isolated metadata works wine at the same time and there no reason to use such limitation in devstack.",
      "parentUuid": "3afb71cf_a3425f66",
      "revId": "29a733a307dd57e176799286e5e27c2194eb3d2b",
      "serverId": "4a232e18-c5a9-48ee-94c0-e04e7cca6543",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "3afb71cf_94b77b39",
        "filename": "/COMMIT_MSG",
        "patchSetId": 1
      },
      "lineNbr": 11,
      "author": {
        "id": 7715
      },
      "writtenOn": "2015-06-10T06:19:22Z",
      "side": 1,
      "message": "Because isolated metadata provides \"route\" of metadata to non-route network that isn\u0027t connected to router. If users can use router, they use router with metadata route not isolated metadata.\n\nWhat happens if isolated metadata network connects to router with metadata route? I guess that devstack must not allow users to set wrong parameters that neutron don\u0027t expect the use case.\n\nIf you assure users that there is no problem at all, I could agree with the patch.",
      "parentUuid": "3afb71cf_117a7d77",
      "revId": "29a733a307dd57e176799286e5e27c2194eb3d2b",
      "serverId": "4a232e18-c5a9-48ee-94c0-e04e7cca6543",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "3afb71cf_a7c36b88",
        "filename": "/COMMIT_MSG",
        "patchSetId": 1
      },
      "lineNbr": 11,
      "author": {
        "id": 14232
      },
      "writtenOn": "2015-06-10T06:54:13Z",
      "side": 1,
      "message": "It\u0027s not a binary choice. User can use one network with a gateway and another without a gateway. And neutron will inject static route via dhcp only in the case when a network doesn\u0027t have a gateway. So yes - there is no problem at all.",
      "parentUuid": "3afb71cf_94b77b39",
      "revId": "29a733a307dd57e176799286e5e27c2194eb3d2b",
      "serverId": "4a232e18-c5a9-48ee-94c0-e04e7cca6543",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "3afb71cf_0a6c86ce",
        "filename": "/COMMIT_MSG",
        "patchSetId": 1
      },
      "lineNbr": 11,
      "author": {
        "id": 7715
      },
      "writtenOn": "2015-06-10T07:27:35Z",
      "side": 1,
      "message": "\u003e User can use one network with a gateway and another without a gateway. And neutron will inject static route via dhcp only in the case when a network doesn\u0027t have a gateway. \n\nDo you mean that neutron don\u0027t set metadata route to the network with a gateway even though isolated_metadata \u003d True?\nIf so, I might misunderstand it.",
      "parentUuid": "3afb71cf_a7c36b88",
      "revId": "29a733a307dd57e176799286e5e27c2194eb3d2b",
      "serverId": "4a232e18-c5a9-48ee-94c0-e04e7cca6543",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "3afb71cf_d6296c8b",
        "filename": "/COMMIT_MSG",
        "patchSetId": 1
      },
      "lineNbr": 11,
      "author": {
        "id": 14232
      },
      "writtenOn": "2015-06-10T11:51:37Z",
      "side": 1,
      "message": "\u003e Do you mean that neutron don\u0027t set metadata route to the network with a gateway even though isolated_metadata \u003d True?\n\nYes, neutron doesn\u0027t set metadata route to the network with a gateway even though isolated_metadata \u003d True.",
      "parentUuid": "3afb71cf_0a6c86ce",
      "revId": "29a733a307dd57e176799286e5e27c2194eb3d2b",
      "serverId": "4a232e18-c5a9-48ee-94c0-e04e7cca6543",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "3afb71cf_d1702f0d",
        "filename": "/COMMIT_MSG",
        "patchSetId": 1
      },
      "lineNbr": 11,
      "author": {
        "id": 7715
      },
      "writtenOn": "2015-06-11T05:52:48Z",
      "side": 1,
      "message": "No, I don\u0027t think so.",
      "parentUuid": "3afb71cf_d6296c8b",
      "revId": "29a733a307dd57e176799286e5e27c2194eb3d2b",
      "serverId": "4a232e18-c5a9-48ee-94c0-e04e7cca6543",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "3afb71cf_78027bb5",
        "filename": "/COMMIT_MSG",
        "patchSetId": 1
      },
      "lineNbr": 11,
      "author": {
        "id": 14232
      },
      "writtenOn": "2015-06-11T07:59:56Z",
      "side": 1,
      "message": "Please see my clarification in the main thread. Thanks!",
      "parentUuid": "3afb71cf_d1702f0d",
      "revId": "29a733a307dd57e176799286e5e27c2194eb3d2b",
      "serverId": "4a232e18-c5a9-48ee-94c0-e04e7cca6543",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "3afb71cf_79d95af2",
        "filename": "/COMMIT_MSG",
        "patchSetId": 1
      },
      "lineNbr": 11,
      "author": {
        "id": 12444
      },
      "writtenOn": "2015-06-11T10:43:17Z",
      "side": 1,
      "message": "I\u0027ve worked on a patch on Neutron\u0027s side regarding exactly this feature [1].\n\n@Hirofumi, Igor is correct in that Neutron allows the user to determine whether or not the metadata service should be supplied by a Neutron router (and hence, by q-l3 - in this case no static routes are needed because the \u0027default\u0027 route will reach the Neutron router anyway, which is managed by q-l3, and it will know what to do with the request), and also by the q-dhcp agent (in the case where a subnet is \"isolated\", that is it doesn\u0027t have a Neutron router in its subnet - the dhcp agent inserts static routes to make sure the metadata requests goes to the correct destination).\n\nBoth are a known use-case - it\u0027s the user\u0027s decision if the tenant network should use a Neutron router for connectivity (and have the metadata serviced by the router implicitly) or having the tenant network use some other, physical router (for example, some generic physical Cisco router - in which case the tenant may decide to enable DHCP service through Neutron, which will also add static routes for the metadata service which is otherwise unreachable).\n\nAlso, having \u0027enable_isolated_metadata \u003d True\u0027 doesn\u0027t mean all metadata requests will go through the DHCP agent - only networks *without* a Neutron router and *with* a dhcp agent have static routes enabled.\n\nHopefully you\u0027ll reconsider this issue :)\n\n[1]: https://review.openstack.org/#/c/123074/",
      "parentUuid": "3afb71cf_78027bb5",
      "revId": "29a733a307dd57e176799286e5e27c2194eb3d2b",
      "serverId": "4a232e18-c5a9-48ee-94c0-e04e7cca6543",
      "unresolved": false
    }
  ]
}