{
  "comments": [
    {
      "key": {
        "uuid": "ff0f0b1f_df81b3c5",
        "filename": "lib/apache",
        "patchSetId": 15
      },
      "lineNbr": 261,
      "author": {
        "id": 5196
      },
      "writtenOn": "2017-05-26T14:28:25Z",
      "side": 1,
      "message": "Is there a reason to move these to the top?",
      "revId": "3a02fac513a7f607d6351705aa80fffedd0e4961",
      "serverId": "4a232e18-c5a9-48ee-94c0-e04e7cca6543",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "ff0f0b1f_bd0cc494",
        "filename": "lib/apache",
        "patchSetId": 15
      },
      "lineNbr": 261,
      "author": {
        "id": 11564
      },
      "writtenOn": "2017-05-26T16:59:38Z",
      "side": 1,
      "message": "Are you asking why they were moved from where they were before?\n\nIf so, the reason is because they are not required when uwsgi is running using http mode, as in line 259/257. They are only required when mod_proxy_uwsgi is being used.\n\nMake the change in this patch was simply a case of taken advantage of the fact that there was stuff in progress. I can split the patches if that\u0027s preferred.",
      "parentUuid": "ff0f0b1f_df81b3c5",
      "revId": "3a02fac513a7f607d6351705aa80fffedd0e4961",
      "serverId": "4a232e18-c5a9-48ee-94c0-e04e7cca6543",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "ff0f0b1f_8aaad7cf",
        "filename": "lib/nova",
        "patchSetId": 15
      },
      "lineNbr": 33,
      "author": {
        "id": 5196
      },
      "writtenOn": "2017-05-26T14:28:25Z",
      "side": 1,
      "message": "Doesn\u0027t this mean there is no way to disable the metadata service? I\u0027m not sure this is ideal, because there are situations where you don\u0027t want to run it.",
      "revId": "3a02fac513a7f607d6351705aa80fffedd0e4961",
      "serverId": "4a232e18-c5a9-48ee-94c0-e04e7cca6543",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "ff0f0b1f_bd128461",
        "filename": "lib/nova",
        "patchSetId": 15
      },
      "lineNbr": 33,
      "author": {
        "id": 11564
      },
      "writtenOn": "2017-05-26T16:59:38Z",
      "side": 1,
      "message": "From what I could tell in my analysis of the code, then if n-api was enabled and n-api-meta was not, then n-api would also run the metadata service (on its own port). And if mod_wsgi was being used then then the metadata service would always get configured.\n\nSo what probably needs to happen here is for the conditional to be:\n\n    if is_service_enabled n-api \u0026\u0026 ! is_service_enabled n-api-meta; then\n        enabled_service n-api-meta\n    fi\n\nThen we get something closer to the original behavior?\n\nDoes that seem right to you? I found this part quite weird to tease out and had been hoping some tests would show where things go wrong, but from looking at the results I guess there are not tests that expect to not find a metadata server.",
      "parentUuid": "ff0f0b1f_8aaad7cf",
      "revId": "3a02fac513a7f607d6351705aa80fffedd0e4961",
      "serverId": "4a232e18-c5a9-48ee-94c0-e04e7cca6543",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "ff0f0b1f_1344bfb6",
        "filename": "lib/nova",
        "patchSetId": 15
      },
      "lineNbr": 33,
      "author": {
        "id": 2750
      },
      "writtenOn": "2017-05-26T17:52:11Z",
      "side": 1,
      "message": "We shouldn\u0027t do this. Instead, add this to the default enabled services in stackrc, and then update gate (which overrides that) to do the same.",
      "parentUuid": "ff0f0b1f_bd128461",
      "revId": "3a02fac513a7f607d6351705aa80fffedd0e4961",
      "serverId": "4a232e18-c5a9-48ee-94c0-e04e7cca6543",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "ff0f0b1f_b6a3c100",
        "filename": "lib/nova",
        "patchSetId": 15
      },
      "lineNbr": 33,
      "author": {
        "id": 11564
      },
      "writtenOn": "2017-05-26T18:09:20Z",
      "side": 1,
      "message": "It\u0027s been long enough since I started this that I guess that updating gate stuff was probably my original plan and I forgot. Can you point me a bit more specifically",
      "parentUuid": "ff0f0b1f_1344bfb6",
      "revId": "3a02fac513a7f607d6351705aa80fffedd0e4961",
      "serverId": "4a232e18-c5a9-48ee-94c0-e04e7cca6543",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "df140735_b0407b09",
        "filename": "lib/nova",
        "patchSetId": 15
      },
      "lineNbr": 33,
      "author": {
        "id": 11564
      },
      "writtenOn": "2017-05-29T12:52:10Z",
      "side": 1,
      "message": "I\u0027ve removed this in the next version to see what blows up.",
      "parentUuid": "ff0f0b1f_b6a3c100",
      "revId": "3a02fac513a7f607d6351705aa80fffedd0e4961",
      "serverId": "4a232e18-c5a9-48ee-94c0-e04e7cca6543",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "ff0f0b1f_4a739f4e",
        "filename": "lib/nova",
        "patchSetId": 15
      },
      "lineNbr": 73,
      "author": {
        "id": 5196
      },
      "writtenOn": "2017-05-26T14:28:25Z",
      "side": 1,
      "message": "I think maybe a note about removing the eventlet path after the pike release",
      "revId": "3a02fac513a7f607d6351705aa80fffedd0e4961",
      "serverId": "4a232e18-c5a9-48ee-94c0-e04e7cca6543",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "df140735_704ae327",
        "filename": "lib/nova",
        "patchSetId": 15
      },
      "lineNbr": 73,
      "author": {
        "id": 11564
      },
      "writtenOn": "2017-05-29T12:52:10Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "ff0f0b1f_4a739f4e",
      "revId": "3a02fac513a7f607d6351705aa80fffedd0e4961",
      "serverId": "4a232e18-c5a9-48ee-94c0-e04e7cca6543",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "ff0f0b1f_33aa2319",
        "filename": "lib/nova",
        "patchSetId": 15
      },
      "lineNbr": 74,
      "author": {
        "id": 2750
      },
      "writtenOn": "2017-05-26T17:52:11Z",
      "side": 1,
      "message": "I\u0027m not thrilled that NOVA_USE_MOD_WSGI actually now means NOVA_USE_UWSGI, because it makes some of the rest hard to reason about.",
      "revId": "3a02fac513a7f607d6351705aa80fffedd0e4961",
      "serverId": "4a232e18-c5a9-48ee-94c0-e04e7cca6543",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "ff0f0b1f_d6875561",
        "filename": "lib/nova",
        "patchSetId": 15
      },
      "lineNbr": 74,
      "author": {
        "id": 11564
      },
      "writtenOn": "2017-05-26T18:09:20Z",
      "side": 1,
      "message": "This is something we talked about as a stop gap until we had something more useful. Does that thing exist yet?",
      "parentUuid": "ff0f0b1f_33aa2319",
      "revId": "3a02fac513a7f607d6351705aa80fffedd0e4961",
      "serverId": "4a232e18-c5a9-48ee-94c0-e04e7cca6543",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "df140735_30546bca",
        "filename": "lib/nova",
        "patchSetId": 15
      },
      "lineNbr": 74,
      "author": {
        "id": 11564
      },
      "writtenOn": "2017-05-29T12:52:10Z",
      "side": 1,
      "message": "I\u0027ve left NOTE that may help with that.",
      "parentUuid": "ff0f0b1f_d6875561",
      "revId": "3a02fac513a7f607d6351705aa80fffedd0e4961",
      "serverId": "4a232e18-c5a9-48ee-94c0-e04e7cca6543",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "ff0f0b1f_b38193c6",
        "filename": "lib/nova",
        "patchSetId": 15
      },
      "lineNbr": 246,
      "author": {
        "id": 2750
      },
      "writtenOn": "2017-05-26T17:52:11Z",
      "side": 1,
      "message": "the stop process should also have vestigial mod_wsgi cleanup for now, so that if you switch modes, or take a new default config, it cleans up both.",
      "revId": "3a02fac513a7f607d6351705aa80fffedd0e4961",
      "serverId": "4a232e18-c5a9-48ee-94c0-e04e7cca6543",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "ff0f0b1f_168dcd7a",
        "filename": "lib/nova",
        "patchSetId": 15
      },
      "lineNbr": 246,
      "author": {
        "id": 11564
      },
      "writtenOn": "2017-05-26T18:09:20Z",
      "side": 1,
      "message": "So you\u0027re saying these two remote lines can be removed?",
      "parentUuid": "ff0f0b1f_b38193c6",
      "revId": "3a02fac513a7f607d6351705aa80fffedd0e4961",
      "serverId": "4a232e18-c5a9-48ee-94c0-e04e7cca6543",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "df140735_f05f13e3",
        "filename": "lib/nova",
        "patchSetId": 15
      },
      "lineNbr": 246,
      "author": {
        "id": 11564
      },
      "writtenOn": "2017-05-29T12:52:10Z",
      "side": 1,
      "message": "I didn\u0027t know what you meant here, so this is still the same in the next version.",
      "parentUuid": "ff0f0b1f_168dcd7a",
      "revId": "3a02fac513a7f607d6351705aa80fffedd0e4961",
      "serverId": "4a232e18-c5a9-48ee-94c0-e04e7cca6543",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "ff0f0b1f_d3652747",
        "filename": "lib/nova",
        "patchSetId": 15
      },
      "lineNbr": 478,
      "author": {
        "id": 2750
      },
      "writtenOn": "2017-05-26T17:52:11Z",
      "side": 1,
      "message": "+1",
      "revId": "3a02fac513a7f607d6351705aa80fffedd0e4961",
      "serverId": "4a232e18-c5a9-48ee-94c0-e04e7cca6543",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "ff0f0b1f_b344f375",
        "filename": "lib/nova",
        "patchSetId": 15
      },
      "lineNbr": 751,
      "author": {
        "id": 2750
      },
      "writtenOn": "2017-05-26T17:52:11Z",
      "side": 1,
      "message": "So, in this case we\u0027re bypassing the tls apache, and just hitting the main one?",
      "revId": "3a02fac513a7f607d6351705aa80fffedd0e4961",
      "serverId": "4a232e18-c5a9-48ee-94c0-e04e7cca6543",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "ff0f0b1f_7672c97e",
        "filename": "lib/nova",
        "patchSetId": 15
      },
      "lineNbr": 751,
      "author": {
        "id": 11564
      },
      "writtenOn": "2017-05-26T18:09:20Z",
      "side": 1,
      "message": "I was (probably incorrectly) assuming that if we are running the services in apache already, then the apache would be doing tls already and we don\u0027t want to be doing a \"tls proxy\" (because that proxies elsewhere).\n\nBut I actually have no idea how the tls stuff is expected to be used, so this could be completely wrong. I tried this to see what it would cause to fail and took a wait and see attitude.",
      "parentUuid": "ff0f0b1f_b344f375",
      "revId": "3a02fac513a7f607d6351705aa80fffedd0e4961",
      "serverId": "4a232e18-c5a9-48ee-94c0-e04e7cca6543",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "ff0f0b1f_96867ddb",
        "filename": "lib/nova",
        "patchSetId": 15
      },
      "lineNbr": 751,
      "author": {
        "id": 5196
      },
      "writtenOn": "2017-05-26T18:24:08Z",
      "side": 1,
      "message": "Right, in this case apache should just do the tls for us since we\u0027re already running a proxy. We only need to explicitly setup the tls proxy if we\u0027re running it with eventlet and therefore don\u0027t have native tls support.\n\nYou can see this in the tempest logs pretty easily:\n\nhttp://logs.openstack.org/15/457715/15/check/gate-tempest-dsvm-neutron-full-ubuntu-xenial/bcd7da0/logs/tempest.txt.gz#_2017-05-17_16_49_55_771\n\nit\u0027s still using https:// there",
      "parentUuid": "ff0f0b1f_7672c97e",
      "revId": "3a02fac513a7f607d6351705aa80fffedd0e4961",
      "serverId": "4a232e18-c5a9-48ee-94c0-e04e7cca6543",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "ff0f0b1f_b30cf394",
        "filename": "stackrc",
        "patchSetId": 15
      },
      "lineNbr": 56,
      "author": {
        "id": 2750
      },
      "writtenOn": "2017-05-26T17:52:11Z",
      "side": 1,
      "message": "+1",
      "revId": "3a02fac513a7f607d6351705aa80fffedd0e4961",
      "serverId": "4a232e18-c5a9-48ee-94c0-e04e7cca6543",
      "unresolved": false
    }
  ]
}