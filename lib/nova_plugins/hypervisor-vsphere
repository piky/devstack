# lib/nova_plugins/hypervisor-vsphere
# Configure the VSphere hypervisor

# Enable with:
# VIRT_DRIVER=vsphere

# Save trace setting
MY_XTRACE=$(set +o | grep xtrace)
set +o xtrace

# Defaults
# --------

DEFAULT_IMAGE_NAME=${DEFAULT_IMAGE_NAME:-debian-2.6.32-i686}
DEFAULT_IMAGE_URLS=${IMAGE_URLS:-"http://partnerweb.vmware.com/programs/vmdkimage/debian-2.6.32-i686.vmdk"}

VMWAREAPI_USER=${VMWAREAPI_USER:-"root"}


# Entry Points
# ------------

# configure_nova_hypervisor() - Set config files, create data dirs, etc
function configure_nova_hypervisor() {
    echo_summary "Using VMware vCenter driver"
    iniset $NOVA_CONF DEFAULT compute_driver "vmwareapi.VMwareVCDriver"
    iniset $NOVA_CONF vmware host_ip "$VMWAREAPI_IP"
    iniset $NOVA_CONF vmware host_username "$VMWAREAPI_USER"
    iniset $NOVA_CONF vmware host_password "$VMWAREAPI_PASSWORD"
    iniset $NOVA_CONF vmware cluster_name "$VMWAREAPI_CLUSTER"
    if is_service_enabled neutron; then
        iniset $NOVA_CONF vmware integration_bridge $OVS_BRIDGE
    fi
}


# Restore xtrace
$MY_XTRACE

# Local variables:
# mode: shell-script
# End:
