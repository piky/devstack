#!/bin/bash
#
# lib/cinder_backends/nfs
# Configure the block_device backend

# Enable with:
#
#   CINDER_ENABLED_BACKENDS+=,block_device:<volume-type-name>

# Dependencies:
#
# - ``functions`` file
# - ``cinder`` configurations

# CINDER_CONF
# CINDER_CONF_DIR
# CINDER_BLOCK_DEVICES - list of block devices managed by the backend

# configure_cinder_backend_block_device - Configure Cinder for block device backends

# Save trace setting
_XTRACE_CINDER_BLOCK_DEVICE=$(set +o | grep xtrace)
set +o xtrace


# Entry Points
# ------------

# configure_cinder_backend_block_device - Set config files
function configure_cinder_backend_block_device {
    local be_name=$1
    iniset $CINDER_CONF $be_name volume_backend_name $be_name
    iniset $CINDER_CONF $be_name volume_driver "cinder.volume.drivers.block_device.BlockDeviceDriver"
    iniset $CINDER_CONF $be_name available_devices $CINDER_BLOCK_DEVICES
}


# Restore xtrace
$_XTRACE_CINDER_BLOCK_DEVICE

# Local variables:
# mode: shell-script
# End:
