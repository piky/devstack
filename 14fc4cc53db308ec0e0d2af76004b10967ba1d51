{
  "comments": [
    {
      "key": {
        "uuid": "7aa08908_4f3cd8c7",
        "filename": "stackrc",
        "patchSetId": 2
      },
      "lineNbr": 146,
      "author": {
        "id": 7118
      },
      "writtenOn": "2016-06-15T00:49:13Z",
      "side": 1,
      "message": "so i\u0027m not really convinced on this.  \n\nI presume you want this so that you\u0027re running stack.sh from a non-interactive ssh session but you want these escape codes put into the log file so when you display it back with \"cat\" you see the colors?\n\nBut just as often people just want a plain-log file in this case, for display via http or download, etc.\n\nSo what I\u0027d rather see us do is switch to default LOG_COLOR to False if output is not going to a tty (\"if [ -t 1 ]\").  I think this follows POLS.\n\nIf we make the change to default False when no tty, we could maybe do this fake vt100 TERM if LOG_COLOR is forced to true ... that probably means that someone went out of their way to set LOG_COLOR so they know what they want",
      "revId": "14fc4cc53db308ec0e0d2af76004b10967ba1d51",
      "serverId": "4a232e18-c5a9-48ee-94c0-e04e7cca6543",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "7aa08908_f26a9980",
        "filename": "stackrc",
        "patchSetId": 2
      },
      "lineNbr": 146,
      "author": {
        "id": 14070
      },
      "writtenOn": "2016-06-15T20:41:33Z",
      "side": 1,
      "message": "Thanks for the review, Ian.  What\u0027s POLS?\n\nI wasn\u0027t trying to make a functional change here.  I assumed sdague had that part right.  I just wanted to fix the error message that gets spit out twice per log entry when LOG_COLOR is enabled, but TERM/-T aren\u0027t set.\n\nAlso, with your suggestion, how would I get an unattended devstack to log in color?  That\u0027s the exact scenario I was trying to solve.",
      "parentUuid": "7aa08908_4f3cd8c7",
      "revId": "14fc4cc53db308ec0e0d2af76004b10967ba1d51",
      "serverId": "4a232e18-c5a9-48ee-94c0-e04e7cca6543",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "7aa08908_b100e101",
        "filename": "stackrc",
        "patchSetId": 2
      },
      "lineNbr": 146,
      "author": {
        "id": 14070
      },
      "writtenOn": "2016-06-16T16:05:11Z",
      "side": 1,
      "message": "Ian, I believe your suggestion would entail leaving the proposed delta as-is, and changing the above assignment of LOG_COLOR as follows:\n\n diff --git a/stackrc b/stackrc\n index c8554f9..d588d56 100644\n --- a/stackrc\n +++ b/stackrc\n @@ -135,8 +135,15 @@ elif [[ -f $RC_DIR/.localrc.auto ]]; then\n      source $RC_DIR/.localrc.auto\n  fi\n \n +# Default for log coloring is based on interactive-or-not\n +if [ -t 1 ]; then\n +    _LOG_COLOR_DEFAULT\u003dTrue\n +else\n +    _LOG_COLOR_DEFAULT\u003dFalse\n +fi\n +\n  # Use color for logging output (only available if syslog is not used)\n -LOG_COLOR\u003d$(trueorfalse True LOG_COLOR)\n +LOG_COLOR\u003d$(trueorfalse $_LOG_COLOR_DEFAULT LOG_COLOR)\n \n  # Make tracing more educational\n  if [[ \"$LOG_COLOR\" \u003d\u003d \"True\" ]]; then",
      "parentUuid": "7aa08908_f26a9980",
      "revId": "14fc4cc53db308ec0e0d2af76004b10967ba1d51",
      "serverId": "4a232e18-c5a9-48ee-94c0-e04e7cca6543",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "7aa08908_40f2739b",
        "filename": "stackrc",
        "patchSetId": 2
      },
      "lineNbr": 146,
      "author": {
        "id": 7118
      },
      "writtenOn": "2016-06-16T22:33:09Z",
      "side": 1,
      "message": "that looks like what i\u0027d expect for setting log color.  please also add a comment to the TPUT_T that with no term but forced color we\u0027ve chosen to just assume vt100 as it seems like a lowest-common-denominator",
      "parentUuid": "7aa08908_b100e101",
      "revId": "14fc4cc53db308ec0e0d2af76004b10967ba1d51",
      "serverId": "4a232e18-c5a9-48ee-94c0-e04e7cca6543",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "7aa08908_c230f6a0",
        "filename": "stackrc",
        "patchSetId": 2
      },
      "lineNbr": 146,
      "author": {
        "id": 14070
      },
      "writtenOn": "2016-06-17T19:43:06Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "7aa08908_40f2739b",
      "revId": "14fc4cc53db308ec0e0d2af76004b10967ba1d51",
      "serverId": "4a232e18-c5a9-48ee-94c0-e04e7cca6543",
      "unresolved": false
    }
  ]
}