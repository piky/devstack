{
  "comments": [
    {
      "key": {
        "uuid": "da20952f_e91d9873",
        "filename": "/COMMIT_MSG",
        "patchSetId": 7
      },
      "lineNbr": 24,
      "author": {
        "id": 6873
      },
      "writtenOn": "2015-09-06T13:49:05Z",
      "side": 1,
      "message": "This could be Closes-Bug so that it closes out the devstack portion of the bug.",
      "revId": "8284c94dd194e9407d5f3d850ec2040a2a2400a6",
      "serverId": "4a232e18-c5a9-48ee-94c0-e04e7cca6543",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "da20952f_84ae437f",
        "filename": "/COMMIT_MSG",
        "patchSetId": 7
      },
      "lineNbr": 24,
      "author": {
        "id": 11904
      },
      "writtenOn": "2015-09-06T14:54:02Z",
      "side": 1,
      "message": "This addresses devstack usage, but I\u0027m still not clear on actual deployment scenarios.\n\nIt seems to me like consumers of the os-brick library need to be able to dynamically pull rootwrap filters in. Not clear yet what the best way would be to do that. Maybe some deployers can chime in.",
      "parentUuid": "da20952f_e91d9873",
      "revId": "8284c94dd194e9407d5f3d850ec2040a2a2400a6",
      "serverId": "4a232e18-c5a9-48ee-94c0-e04e7cca6543",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "da20952f_44fb4b79",
        "filename": "/COMMIT_MSG",
        "patchSetId": 7
      },
      "lineNbr": 24,
      "author": {
        "id": 6873
      },
      "writtenOn": "2015-09-06T15:02:24Z",
      "side": 1,
      "message": "We had talked about ways of trying to get this to automatically work but since pip doesn\u0027t install things to /etc and we can\u0027t assume people are using distro packages (debs/rpms), I think we\u0027re going to have to rely on deploy/config mgmt tooling like chef/puppet/ansible to copy this file over like we\u0027re doing in devstack.  I think this is actually the first case of a rootwrap filter being shared between libraries like this so there are probably better ways of sorting this out.  There was an oslo spec related to rootwrap mentioned in the bug report I think, but it\u0027s not mature yet.",
      "parentUuid": "da20952f_84ae437f",
      "revId": "8284c94dd194e9407d5f3d850ec2040a2a2400a6",
      "serverId": "4a232e18-c5a9-48ee-94c0-e04e7cca6543",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "da20952f_153690e7",
        "filename": "/COMMIT_MSG",
        "patchSetId": 7
      },
      "lineNbr": 24,
      "author": {
        "id": 5196
      },
      "writtenOn": "2015-09-08T20:56:38Z",
      "side": 1,
      "message": "You can package data files with pbr, the output dir is a bit weird because setuptools doesn\u0027t really do it well. Take a look at:\n\nhttp://docs.openstack.org/developer/pbr/#files",
      "parentUuid": "da20952f_44fb4b79",
      "revId": "8284c94dd194e9407d5f3d850ec2040a2a2400a6",
      "serverId": "4a232e18-c5a9-48ee-94c0-e04e7cca6543",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "da20952f_b5c24433",
        "filename": "/COMMIT_MSG",
        "patchSetId": 7
      },
      "lineNbr": 24,
      "author": {
        "id": 6873
      },
      "writtenOn": "2015-09-08T21:11:14Z",
      "side": 1,
      "message": "Sure, but the problem is getting the os-brick.filters into /etc/nova/rootwrap.d and /etc/cinder/rootwrap.d/, especially when os-brick is installed first since it\u0027s a dependency for both nova and cinder.",
      "parentUuid": "da20952f_153690e7",
      "revId": "8284c94dd194e9407d5f3d850ec2040a2a2400a6",
      "serverId": "4a232e18-c5a9-48ee-94c0-e04e7cca6543",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "da20952f_55eac8ad",
        "filename": "inc/rootwrap",
        "patchSetId": 7
      },
      "lineNbr": 87,
      "author": {
        "id": 6873
      },
      "writtenOn": "2015-09-08T21:11:14Z",
      "side": 1,
      "message": "Maybe rename the local variable \u0027project\u0027 as \u0027service\u0027 since os-brick is a project (and a library), and nova is a project - but not a library, it\u0027s a service.",
      "revId": "8284c94dd194e9407d5f3d850ec2040a2a2400a6",
      "serverId": "4a232e18-c5a9-48ee-94c0-e04e7cca6543",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "da20952f_5512c80a",
        "filename": "inc/rootwrap",
        "patchSetId": 7
      },
      "lineNbr": 88,
      "author": {
        "id": 2750
      },
      "writtenOn": "2015-09-08T21:07:57Z",
      "side": 1,
      "message": "ok, please never populate args in reverse order like this, this is all kinds of confusing to debug. This is a -1.",
      "revId": "8284c94dd194e9407d5f3d850ec2040a2a2400a6",
      "serverId": "4a232e18-c5a9-48ee-94c0-e04e7cca6543",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "da20952f_358074f7",
        "filename": "inc/rootwrap",
        "patchSetId": 7
      },
      "lineNbr": 89,
      "author": {
        "id": 2750
      },
      "writtenOn": "2015-09-08T21:07:57Z",
      "side": 1,
      "message": "this seems weird, that\u0027s a very oddly deep tree in a library, and not something I\u0027d like to make cannon via devstack.\n\netc/rootwrap/*.filters is fine, but please don\u0027t map a whole filesystem into here.",
      "range": {
        "startLine": 89,
        "startChar": 50,
        "endLine": 89,
        "endChar": 56
      },
      "revId": "8284c94dd194e9407d5f3d850ec2040a2a2400a6",
      "serverId": "4a232e18-c5a9-48ee-94c0-e04e7cca6543",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "da20952f_55eba878",
        "filename": "inc/rootwrap",
        "patchSetId": 7
      },
      "lineNbr": 89,
      "author": {
        "id": 6873
      },
      "writtenOn": "2015-09-08T21:15:39Z",
      "side": 1,
      "message": "I believe the filter was added in os-brick using the same structure as in cinder and nova - that\u0027s all:\n\nhttps://github.com/openstack/cinder/blob/master/etc/cinder/rootwrap.d/volume.filters\n\nhttps://github.com/openstack/cinder/blob/master/etc/cinder/rootwrap.d/volume.filters\n\nso etc/\u003cproject\u003e/rootwrap.d/*.filters",
      "parentUuid": "da20952f_358074f7",
      "revId": "8284c94dd194e9407d5f3d850ec2040a2a2400a6",
      "serverId": "4a232e18-c5a9-48ee-94c0-e04e7cca6543",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "da20952f_9885f55a",
        "filename": "inc/rootwrap",
        "patchSetId": 7
      },
      "lineNbr": 89,
      "author": {
        "id": 2750
      },
      "writtenOn": "2015-09-08T21:24:50Z",
      "side": 1,
      "message": "so, I think the problem I have is that this violates the principle of least surprise for users.\n\nCurrently there is an /etc/os-brick/rootwrap.d/*.filters in tree, and on the filesystem. However, /etc/os-brick/rootwrap.d/*.filter on the filesystem is vestigial. It does nothing. To an untrained user they would assume it was like other /etc/$foo/rootwrap.d/ directories, where they can change things, an stuff happens. But it isn\u0027t. So it\u0027s actively dangerous in building a correct system.\n\nBy similar reasoning, making the in tree bits look like an etc tree like that will make people think that their job is to copy it into that location, it looks like the nova location, so clearly it works that way. Except it doesn\u0027t.\n\nSo lets change the in tree os-brick location to etc/rootwrap/*filters (put a README.txt) in that directory to explain where you are supposed to install it into. Stop installing it in /etc/os-brick with PBR to get rid of that confusion. \n\nI do realize this requires another os-brick release, but I think it\u0027s important from a UX perspective, as this is going to be harder to undo once it\u0027s out there.",
      "parentUuid": "da20952f_55eba878",
      "revId": "8284c94dd194e9407d5f3d850ec2040a2a2400a6",
      "serverId": "4a232e18-c5a9-48ee-94c0-e04e7cca6543",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "da20952f_44a9b48f",
        "filename": "inc/rootwrap",
        "patchSetId": 7
      },
      "lineNbr": 89,
      "author": {
        "id": 6873
      },
      "writtenOn": "2015-09-09T00:11:57Z",
      "side": 1,
      "message": "Here is the os-brick change:\n\nhttps://review.openstack.org/#/c/221513/",
      "parentUuid": "da20952f_9885f55a",
      "revId": "8284c94dd194e9407d5f3d850ec2040a2a2400a6",
      "serverId": "4a232e18-c5a9-48ee-94c0-e04e7cca6543",
      "unresolved": false
    }
  ]
}